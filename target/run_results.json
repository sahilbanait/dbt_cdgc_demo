{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-17T07:15:01.198599Z", "invocation_id": "20fa558a-760e-49d6-818f-a05a0a8d5ade", "invocation_started_at": "2025-09-17T07:14:00.466917Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:32.953299Z", "completed_at": "2025-09-17T07:14:32.959855Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:32.960797Z", "completed_at": "2025-09-17T07:14:45.752811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 12.80055546760559, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-77e0-000f-ce73000977fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.stg_accounts", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        account_id,\n        customer_id,\n        account_type,\n        account_status,\n        opening_date,\n        current_balance,\n        credit_limit,\n        interest_rate,\n        last_activity_date,\n        current_timestamp() as dbt_updated_at\n    from DEV_RAW_DB.FINANCE.ACCOUNT_INFORMATION\n    where account_status = 'Active'\n)\n\nselect * from source_data", "relation_name": "DEV_STAGING_DB.RAW_staging.stg_accounts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:45.765836Z", "completed_at": "2025-09-17T07:14:45.773001Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:45.773001Z", "completed_at": "2025-09-17T07:14:46.433174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6693363189697266, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-7680-000f-ce730008f8b6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.stg_customers", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        customer_id,\n        first_name,\n        last_name,\n        email,\n        phone,\n        date_of_birth,\n        address,\n        city,\n        state,\n        zip_code,\n        customer_segment,\n        acquisition_date,\n        risk_rating,\n        gdpr_consent,\n        created_date,\n        last_modified_date,\n        current_timestamp() as dbt_updated_at\n    from DEV_RAW_DB.CUSTOMERS.CUSTOMERS_MASTER\n)\n\nselect * from source_data", "relation_name": "DEV_STAGING_DB.RAW_staging.stg_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:46.441271Z", "completed_at": "2025-09-17T07:14:46.446270Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:46.447275Z", "completed_at": "2025-09-17T07:14:46.909746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4694805145263672, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-77e0-000f-ce7300097802"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.stg_transactions", "compiled": true, "compiled_code": "\n\nwith source_data as (select transaction_id,\n                            customer_id,\n                            account_id,\n                            transaction_date,\n                            transaction_type,\n                            amount,\n                            currency,\n                            channel,\n                            status,\n                            merchant_name,\n                            category,\n                            created_timestamp,\n                            current_timestamp() as dbt_updated_at\n                     from DEV_RAW_DB.FINANCE.FINANCIAL_TRANSACTIONS\n                     where status = 'Completed')\n\nselect *\nfrom source_data", "relation_name": "DEV_STAGING_DB.RAW_staging.stg_transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:46.914260Z", "completed_at": "2025-09-17T07:14:46.919095Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:46.920072Z", "completed_at": "2025-09-17T07:14:49.574998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6632206439971924, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-7689-000f-ce73000a40ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.int_customer_metrics", "compiled": true, "compiled_code": "\n\nwith customer_transactions as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        c.risk_rating,\n        count(t.transaction_id) as total_transactions,\n        sum(t.amount) as total_transaction_amount,\n        avg(t.amount) as avg_transaction_amount,\n        min(t.transaction_date) as first_transaction_date,\n        max(t.transaction_date) as last_transaction_date\n    from DEV_STAGING_DB.RAW_staging.stg_customers c\n    left join DEV_STAGING_DB.RAW_staging.stg_transactions t\n        on c.customer_id = t.customer_id\n    group by 1, 2, 3\n),\n\ncustomer_accounts as (\n    select\n        customer_id,\n        count(account_id) as total_accounts,\n        sum(current_balance) as total_balance,\n        avg(current_balance) as avg_balance\n    from DEV_STAGING_DB.RAW_staging.stg_accounts\n    group by 1\n)\n\nselect\n    ct.*,\n    ca.total_accounts,\n    ca.total_balance,\n    ca.avg_balance,\n    current_timestamp() as dbt_updated_at\nfrom customer_transactions ct\nleft join customer_accounts ca\n    on ct.customer_id = ca.customer_id", "relation_name": "DEV_PRESENTATION_DB.RAW_intermediate.int_customer_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:49.579489Z", "completed_at": "2025-09-17T07:14:49.582488Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:49.582488Z", "completed_at": "2025-09-17T07:14:51.418210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8397221565246582, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-77e0-000f-ce7300097806"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.int_risk_assessment", "compiled": true, "compiled_code": "\n\nwith risk_factors as (\n    select\n        customer_id,\n        case\n            when total_transaction_amount > 100000 then 'High Volume'\n            when total_transaction_amount > 50000 then 'Medium Volume'\n            else 'Low Volume'\n        end as transaction_volume_risk,\n        case\n            when avg_transaction_amount > 5000 then 'High Value'\n            when avg_transaction_amount > 1000 then 'Medium Value'\n            else 'Low Value'\n        end as transaction_value_risk,\n        case\n            when total_balance > 50000 then 'High Balance'\n            when total_balance > 10000 then 'Medium Balance'\n            else 'Low Balance'\n        end as balance_risk\n    from DEV_PRESENTATION_DB.RAW_intermediate.int_customer_metrics\n)\n\nselect\n    *,\n    case\n        when transaction_volume_risk = 'High Volume'\n             and transaction_value_risk = 'High Value'\n             and balance_risk = 'High Balance' then 'Critical'\n        when transaction_volume_risk in ('High Volume', 'Medium Volume')\n             or transaction_value_risk in ('High Value', 'Medium Value') then 'Elevated'\n        else 'Standard'\n    end as composite_risk_score,\n    current_timestamp() as dbt_updated_at\nfrom risk_factors", "relation_name": "DEV_PRESENTATION_DB.RAW_intermediate.int_risk_assessment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:51.422604Z", "completed_at": "2025-09-17T07:14:51.428672Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:51.429193Z", "completed_at": "2025-09-17T07:14:52.808927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.387402057647705, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-7800-000f-ce73000957ae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.dim_customers", "compiled": true, "compiled_code": "\n\nselect\n    c.customer_id,\n    c.first_name,\n    c.last_name,\n    c.email,\n    c.city,\n    c.state,\n    c.customer_segment,\n    c.acquisition_date,\n    c.risk_rating as original_risk_rating,\n    r.composite_risk_score as calculated_risk_score,\n    m.total_transactions,\n    m.total_transaction_amount,\n    m.total_accounts,\n    m.total_balance,\n    c.gdpr_consent,\n    current_timestamp() as dbt_updated_at\nfrom DEV_STAGING_DB.RAW_staging.stg_customers c\nleft join DEV_PRESENTATION_DB.RAW_intermediate.int_customer_metrics m\n    on c.customer_id = m.customer_id\nleft join DEV_PRESENTATION_DB.RAW_intermediate.int_risk_assessment r\n    on c.customer_id = r.customer_id", "relation_name": "DEV_MARTS_DB.RAW_marts.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:52.813132Z", "completed_at": "2025-09-17T07:14:52.816450Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:52.816967Z", "completed_at": "2025-09-17T07:14:54.520374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7077984809875488, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-768a-000f-ce730009b7f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.fact_transactions", "compiled": true, "compiled_code": "\n\nselect\n    t.transaction_id,\n    t.customer_id,\n    t.account_id,\n    t.transaction_date,\n    t.transaction_type,\n    t.amount,\n    t.currency,\n    t.channel,\n    t.merchant_name,\n    t.category,\n    c.customer_segment,\n    a.account_type,\n    r.composite_risk_score,\n    current_timestamp() as dbt_updated_at\nfrom DEV_STAGING_DB.RAW_staging.stg_transactions t\nleft join DEV_MARTS_DB.RAW_marts.dim_customers c\n    on t.customer_id = c.customer_id\nleft join DEV_STAGING_DB.RAW_staging.stg_accounts a\n    on t.account_id = a.account_id\nleft join DEV_PRESENTATION_DB.RAW_intermediate.int_risk_assessment r\n    on t.customer_id = r.customer_id", "relation_name": "DEV_MARTS_DB.RAW_marts.fact_transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:54.526604Z", "completed_at": "2025-09-17T07:14:54.531730Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:54.532743Z", "completed_at": "2025-09-17T07:14:55.918280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3936941623687744, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-766b-000f-ce7300090876"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.customer_360_view", "compiled": true, "compiled_code": "\n\nselect\n    c.customer_id,\n    c.first_name || ' ' || c.last_name as full_name,\n    c.email,\n    c.city,\n    c.state,\n    c.customer_segment,\n    c.original_risk_rating,\n    c.calculated_risk_score,\n    c.total_transactions,\n    c.total_transaction_amount,\n    c.total_accounts,\n    c.total_balance,\n    c.gdpr_consent,\n    -- Transaction patterns\n    t_summary.recent_transaction_date,\n    t_summary.preferred_channel,\n    t_summary.top_category,\n    -- Account summary\n    a_summary.primary_account_type,\n    a_summary.account_opening_date,\n    current_timestamp() as dbt_updated_at\nfrom DEV_MARTS_DB.RAW_marts.dim_customers c\nleft join (\n    select\n        customer_id,\n        max(transaction_date) as recent_transaction_date,\n        mode(channel) as preferred_channel,\n        mode(category) as top_category\n    from DEV_MARTS_DB.RAW_marts.fact_transactions\n    group by 1\n) t_summary on c.customer_id = t_summary.customer_id\nleft join (\n    select\n        customer_id,\n        mode(account_type) as primary_account_type,\n        min(opening_date) as account_opening_date\n    from DEV_STAGING_DB.RAW_staging.stg_accounts\n    group by 1\n) a_summary on c.customer_id = a_summary.customer_id", "relation_name": "DEV_MARTS_DB.RAW_marts.customer_360_view", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-17T07:14:55.923229Z", "completed_at": "2025-09-17T07:14:55.926738Z"}, {"name": "execute", "started_at": "2025-09-17T07:14:55.926738Z", "completed_at": "2025-09-17T07:14:57.286137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3639063835144043, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1b32-0306-77e2-000f-ce730009a7fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.cdgc_demo.regulatory_report", "compiled": true, "compiled_code": "\n\n-- GDPR Compliance Report\nselect\n    'GDPR_CUSTOMER_COUNT' as metric_name,\n    count(*) as metric_value,\n    'Total customers with GDPR consent' as description,\n    current_date() as report_date\nfrom DEV_MARTS_DB.RAW_marts.dim_customers\nwhere gdpr_consent = true\n\nunion all\n\nselect\n    'HIGH_RISK_CUSTOMERS' as metric_name,\n    count(*) as metric_value,\n    'Customers with high risk rating' as description,\n    current_date() as report_date\nfrom DEV_MARTS_DB.RAW_marts.dim_customers\nwhere calculated_risk_score = 'Critical'\n\nunion all\n\nselect\n    'HIGH_VALUE_TRANSACTIONS' as metric_name,\n    count(*) as metric_value,\n    'Transactions above $10,000' as description,\n    current_date() as report_date\nfrom DEV_MARTS_DB.RAW_marts.fact_transactions\nwhere amount > 10000\n\nunion all\n\nselect\n    'TOTAL_TRANSACTION_VOLUME' as metric_name,\n    sum(amount) as metric_value,\n    'Total transaction volume for regulatory reporting' as description,\n    current_date() as report_date\nfrom DEV_MARTS_DB.RAW_marts.fact_transactions\nwhere transaction_date >= dateadd(month, -1, current_date())", "relation_name": "DEV_MARTS_DB.RAW_marts.regulatory_report", "batch_results": null}], "elapsed_time": 58.68992638587952, "args": {"require_yaml_configuration_for_mf_time_spines": false, "which": "run", "version_check": true, "show_resource_report": false, "use_colors_file": true, "validate_macro_args": false, "invocation_command": "dbt run", "require_batched_execution_for_custom_microbatch_strategy": false, "log_format": "default", "exclude": [], "indirect_selection": "eager", "profiles_dir": "C:\\Users\\sahil\\.dbt", "partial_parse_file_diff": true, "partial_parse": true, "require_nested_cumulative_type_params": false, "select": [], "require_all_warnings_handled_by_warn_error": false, "upload_to_artifacts_ingest_api": false, "cache_selected_only": false, "write_json": true, "printer_width": 80, "empty": false, "log_format_file": "debug", "vars": {}, "print": true, "macro_debugging": false, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "state_modified_compare_vars": false, "show_all_deprecations": false, "require_generic_test_arguments_property": true, "use_colors": true, "log_path": "D:\\git\\dbt_cdgc_demo\\logs", "introspect": true, "log_level": "info", "log_level_file": "debug", "strict_mode": false, "defer": false, "populate_cache": true, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "project_dir": "D:\\git\\dbt_cdgc_demo", "quiet": false, "log_file_max_bytes": 10485760, "use_fast_test_edges": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "skip_nodes_if_on_run_start_fails": false}}